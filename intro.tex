\chapter{Introduction}

L'apprentissage consiste à

\begin{itemize}
	\item améliorer les performances d'un ordinateur dans certaines tâches, avec de l'expérience ;
	\item extraire un modèle d'un système en se basant sur les observations de ce systèmes dans certaines situations ;
	\item créer un modèle, c'est-à-dire une relation entre les variables utilisées pour décrire le système.
\end{itemize}

Les deux buts principaux de l'apprentissage sont la prédiction et la meilleure compréhension d'un système.

L'apprentissage est utilise quand il n'y a pas d'expertise humaine, quand les humains ne sont pas capables d'expliquer leur expertise, quand les solutions changent au cours du temps ou quand les solutions nécessitent d'être adaptées à des cas particuliers.

\dessinS{1}{.4}

L'exploration de données se déroulent en plusieurs étapes :

\begin{enumerate}
	\item Génération de données ;
	\item Préprocessing : normalisation des valeurs, traitement des valeurs manquantes, sélections d'une composante, etc ;
	\item Apprentissage : développement d'une hypothèse, choix d'un algorithme d'apprentissage, etc ;
	\item Validation d'hypothèse : validation croisée, déploiement du modèle, etc.
\end{enumerate}

	\section{Glossaire}
	
	\dessinS{2}{.4}

	\section{Protocoles d'apprentissage automatique}
	
	% TODO Apprentissage supervisé, non-supervisé, apprentissage par renforcement, apprentissage en mode batch vs apprentissage on-line, apprentissage semi-supervisé et transductif.  Donner un exemple de problème pratique et de méthode pour chaque type de protocole.
	
	
		\subsection{Apprentissage supervisé}
		
		L'apprentissage supervisé consiste, à partir de la base de donnée (learning sample, échantillon de test), à trouver une fonction $f$ qui prend entrée les variables du problème et qui approxime au mieux la sortie :

		$$\hat{Y} = f(X_1, X_2, X_3, X_4)$$

		Plus formellement, l'apprentissage consiste, à partir d'un échantillon d'apprentissage $\ens{(x_i, y_i) \vert i = 1, \dots , N}$, avec $x_i \in \mathcal{X}$ et $y_i \in \mathcal{Y}$, à trouver une fonction $f : \mathcal{X} \rightarrow \mathcal{Y}$ qui minimise la fonction de probabilité de perte $l : \mathcal{Y} \times \mathcal{Y} \rightarrow \mathbb{R}$ sur la distribution jointe des paires d'entrées sorties : $E_{x, y} \ens{l(f(x), y)}$.

		Cette fonction de perte $l$ prend en entrée deux sorties $Y$ et retourne 1 si elles sont équivalentes, 0 sinon.

		Lorsque la sortie est une valeur symbolique, on parle de classification. Si la sortie est une valeur numérique, on parle de régression.

		Un modèle sera déterministe s'il est parfait, c'est-à-dire s'il a une règle de classification qui ne commet par d'erreur.
		
		\subsection{Algorithme d'apprentissage}
		
		Un algorithme d'apprentissage est défini par

		\begin{itemize}
			\item une famille de modèles candidats (un espace d'hypothèses $H$),
			\item une mesure de la qualité d'un modèle, et
			\item une stratégie d'optimisation.
		\end{itemize}

		L'algorithme va ainsi, à partir de l'échantillon d'apprentissage, retourner la fonction $h$ de $H$ de meilleur qualité.
		
			\subsubsection{Exemples}
			
			% TODO
			
			\subsubsection{Modes batch et on-line}
		
			En mode batch, les échantillons sont fournis et traités ensembles pour construire un modèle. Il n'est pas nécessaire de stocker le modèle mais bien ces exemples. C'est une approche classique pour l'exploitation de données (data mining).
			
		En mode online, les échantillons sont fournis et traités un à un pour mettre à jour un modèle. Ici, il faut stocker le modèle (et non les exemples). C'est une approche fortement utilisées pour les systèmes adaptatifs.
		
			On peut cependant passer facilement d'un mode à l'autre :
		
			\begin{itemize}
				\item les échantillons peuvent être fournis ensembles, mais exploités un à un
				\item les échantillons peuvent être fournis un à un, mais sont stockés et exploités ensemble.
			\end{itemize}
		
		\subsection{Apprentissage non-supervisé}
		
		L'apprentissage non-supervisé consiste à trouver des régularités dans les données, sans indications sur des entrées et des sorties. On cherche ainsi quels sont les groupes de variables ou d'objets intéressants, et s'il y a des dépendances entre les variables.
		
			\subsubsection{Exemples}
			
			% TODO
		
		\subsection{Apprentissage semi-supervisé}
		
		Il faut distinguer deux types de données : celles qui sont labellisées des données non-labellisées. Une donnée non labellisée est une paire entrée-sortie sans valeur de sortir. Elles sont plus faciles à obtenir que des données labellisées car
		
		\begin{itemize}
			\item les labels peuvent nécessiter une intervention/expertise humaine, qui peut être chère, lente et non fiable
			\item les labels peuvent nécessiter des équipements spéciaux.
		\end{itemize}
		
		Des données non labellisées se retrouvent dans le domaine biomédical, dans l'analyse du langage, dans le parsage du langage naturel, dans la catégorisation d'image ou dans la mesure de réseau.
				
		Le but de l'apprentissage non-supervisé est d'exploiter tout type de données, labellisées ou non, et de construire de meilleurs modèles qu'en utilisant seulement un seul de ces types.
		
		On utilise pour cela de l'auto-apprentissage (on labellise les données non labellisées avec un modèle entraîné sur les données labellisées) ou des algorithmes semi-supervisés (par exemple le semi-supervised SVM : on énumère tous les labels possibles pour les données non labelisées, on apprend une SVM pour chaque labeling, et on prend celui qui donne la plus grande marge).
		
		\subsection{Apprentissage transductif}
		
		Ce type d'apprentissage est similaire à l'apprentissage supervisé, mais on a accès aux données de test dès le début, ce qu'on exploite plus. On ne veut pas simplement un modèle, on veut aussi calculer des prédictions pour des données non labellisées.
		
		Pour cela, on utilise de l'apprentissage semi-supervisé en utilisant les données à tester comme données non labellisées  pour obtenir un modèle, et on l'utilise pour faire des prédictions sur les données de test. Il existe également des algorithmes spécifiques qui évitent purement et simplement la construction d'un modèle.
		
		\subsection{Apprentissage par renforcement}
		
		Il s'agit d'un apprentissage basé sur des interactions :
		
		\dessinS{110}{.3}
		
		Le but est de choisir une séquence d'actions (une politique) qui maximise $r_0 + \gamma r_1 + \gamma^2 r_2 + \dots$, avec $0 \leq \gamma < 1$.
		
		\dessinS{109}{.3} % TODO Mettre R2D2 à la place
		
		Un système est généralement modélisé par
		
		\begin{itemize}
			\item des probabilités de transition à un état $P(s_{t + 1} \vert s_t, a_t)$
			\item des probabilités de récompense $P(r_{t + 1} \vert s_t, a_t)$ 		(processus de décision de Markov).
		\end{itemize}
		
		Si le modèle des dynamiques et e la récompense est connu, on va calculer la politique optimale à adopter par programmation dynamique.
		
		Si le modèle n'est pas connu, deux approches sont possibles :
		
		\begin{itemize}
			\item on base sur un modèle : on apprend d'abord un modèle des dynamiques et on en dérive une politique optimale
			\item on n'utilise pas de modèle : on apprend directement la politique en se basant sur les observations des trajectoires du système.
		\end{itemize}
		
			\subsubsection{Renforcement vs. supervisé}
			
			\begin{center}
			\begin{tabular}{|c|c|c|}
			\hline 
			  & Supervisé & Renforcement \\ 
			\hline 
			Mode batch & \pbox{7.5cm}{Apprentissage d'un mapping d'une entrée vers une sortie à partir d'observations de paires entrée-sortie} & \pbox{7.5cm}{Apprentissage d'un mapping d'un état vers une action à partir de tripets (état, action, récompense) observés} \\ 
			\hline 
			Mode online & \pbox{7.5cm}{(Actif learning) combinaison d'apprentissage supervisé et de sélection (online) d'instances pour labeller} & \pbox{7.5cm}{Combinaison d'apprentissage de politique avec un contrôle du système et avec la génération de trajectoires d'entraînement} \\ 
			\hline 
			\end{tabular} 
			\end{center}
			
			L'apprentissage par renforcement pourrait se réduire à de l'apprentissage supervisé si l'action optimale était connue pour chaque état. De plus, l'apprentissage supervisé est utilisé par l'apprentissage par renforcement pour modéliser les dynamiques du système et/ou les fonctions de récompense.
			
			\subsubsection{Exemples}
			
			% TODO
		
		\subsection{Apprentissage actif}
		
		Pour des données non labellisées, on veut trouver (de manière adaptive) dse exemples à labellisées afin d'apprendre un modèle précis. L'espoir est de réduire le nombre d'instances labellisées en utilisant l'apprentissage supervisé de type batch.
		
		Généralement, on a une configuration de type online : on choisit les $k$ meilleurs exemples non labellisés, on détermine leurs labels, on met à jour le modèle et on itère.
		
		Les algorithmes diffèrent dans la façon dont les exemples non labellisés sont choisis.
		
